<!DOCTYPE html>
<html>
<head>
  <title>Clear QUAR Editor Cache</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 600px;
      margin: 50px auto;
      padding: 20px;
      background: #0A0A0B;
      color: #FAFAFA;
    }
    button {
      background: linear-gradient(135deg, #7C3AED, #A855F7);
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px 0;
    }
    button:hover {
      opacity: 0.9;
    }
    .status {
      margin: 20px 0;
      padding: 10px;
      background: #18181B;
      border-radius: 8px;
      border: 1px solid #27272A;
    }
    .success {
      color: #10B981;
    }
    .error {
      color: #EF4444;
    }
  </style>
</head>
<body>
  <h1>Clear QUAR Editor Cache</h1>
  <p>This will unregister all service workers and clear all caches.</p>

  <button onclick="clearAll()">Clear All Caches & Service Workers</button>

  <div id="status" class="status"></div>

  <script>
    async function clearAll() {
      const statusDiv = document.getElementById('status');
      statusDiv.innerHTML = '<p>Clearing...</p>';

      try {
        // Unregister all service workers
        const registrations = await navigator.serviceWorker.getRegistrations();
        for (let registration of registrations) {
          await registration.unregister();
          statusDiv.innerHTML += '<p class="success">✓ Unregistered service worker</p>';
        }

        // Clear all caches
        const cacheNames = await caches.keys();
        for (let cacheName of cacheNames) {
          await caches.delete(cacheName);
          statusDiv.innerHTML += `<p class="success">✓ Deleted cache: ${cacheName}</p>`;
        }

        statusDiv.innerHTML += '<p class="success"><strong>✓ All caches and service workers cleared!</strong></p>';
        statusDiv.innerHTML += '<p>Now close this tab and do a hard refresh (Cmd+Shift+R on Mac, Ctrl+Shift+R on Windows) on your app.</p>';

      } catch (error) {
        statusDiv.innerHTML += `<p class="error">✗ Error: ${error.message}</p>`;
      }
    }
  </script>
</body>
</html>
